#!/bin/sh

# prints the full name of the first kubernetes pod whose name
# contains <string>.
# kcid [<options>] <name>
#   Options:
#     -n <namespace>      default to "lockss"


namespace="lockss"

while [ -n "$1" ]; do
  case "$1" in
    "-n" )
      namespace="$2"
      shift; shift; continue ;;
    -* )
      echo "Invalid option: $1"
      exit 1
      ;;
    * )
      break
      ;;
  esac
done

name="$1"

# aliases for the lazy
case "$1" in
    "cfg" )
        name=config
        break;;
    "mdx" )
        name=metadata-extract
        break;;
    "mdq" )
        name=metadata-service
        break;;
esac

microk8s kubectl get po -n "${namespace}" -oname | sed 's|pod/||' | awk "/$name/"' { print $1 ; exit 0 }'
